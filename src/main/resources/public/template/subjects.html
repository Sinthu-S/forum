<h2>[[category.name]]</h2>

<div class="twelve cell">
	<behaviour name="publish" resource="category" class="contextual-buttons row">
		<div>
			<button ng-click="newSubject()"><i18n>forum.subject.new</i18n></button>
		</div>
	</behaviour>
	<div class="row vertical-spacing"></div>
	<table class="twelve">
		<tbody>
			<tr ng-repeat="subject in subjects.all" ng-class="{ checked: subject.selected }">
				<td>
					<behaviour name="manage" resource="category">
						<input type="checkbox" ng-model="subject.selected" />
					</behaviour>
				</td>
				<td ng-click="openSubject(subject)"><i class="prive" ng-if="subject.locked"></i> <a>[[subject.title]]</a></td>
				<td ng-click="openSubject(subject)">[[subject.nbMessages]] réponse(s)</td>
				<td ng-click="openSubject(subject)">
					<i18n>forum.by</i18n>[[subject.lastMessage.owner.displayName]]<i18n>forum.on.the</i18n>[[formatDate(subject.lastMessage.created.$date)]]
				</td>
			</tr>
		</tbody>

	</table>
	<div ng-if="subjects.all.length === 0">
		Aucun sujet de discussion n'a été ouvert dans cette catégorie !
	</div>
</div>

<behaviour name="publish" resource="category" class="cell">
	<section class="toggle-buttons" ng-class="{ hide: subjects.selection().length === 0 }">
		<div class="toggle">
			<div class="row">
				<button ng-click="subjects.removeSelection()"><i18n>remove</i18n></button>
				<button
						ng-if="(subjects.where({ locked: undefined, selected: true}).length > 0 || subjects.where({ locked: false, selected: true}).length > 0)
								&& subjects.where({ locked: true, selected: true}).length === 0"
						ng-click="subjects.lockSelection()"
				>
					<i18n>lock</i18n>
				</button>
				<button ng-if="subjects.where({ locked: true, selected: true}).length > 0 
								&& (subjects.where({ locked: undefined, selected: true}).length === 0 || subjects.where({ locked: false, selected: true}).length === 0)"
						ng-click="subjects.unlockSelection()"
				>
					<i18n>unlock</i18n>
				</button>
			</div>
		</div>
	</section>
</behaviour>