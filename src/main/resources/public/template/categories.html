<h1><i18n ng-click="openMainPage()">forum.title</i18n></h1>

<div class="patchwork">
	<div class="twelve cell">
		<div workflow="forum.admin" class="cell">
			<button ng-click="newCategory()"><i18n>forum.category.new</i18n></button>
		</div>
		<i class="open-right right-magnet big-hidden" ng-click="template.close('main')"></i>
	</div>
	<hr />
	<div class="row" ng-repeat="cat in categories.all" ng-click="openCategory(cat)" ng-class="{ selected: cat === category }">
		<div class="cell">
			<img skin-src="/img/illustrations/forum-default.png" ng-if="(cat.icon === undefined)" class="cell" />
			<img ng-src="[[cat.icon]]?thumbnail=120x120" ng-if="cat.icon !== undefined" class="cell" />
		</div>
		<article class="six cell">
			<h1>[[cat.name]]</h1>
			<strong class="small-text">
				<span class="right-magnet" style="line-height: 50px" ng-if="category.nbNewMessages > 1">
					[[category.nbNewMessages]]
					<i18n>forum.message.new.plural</i18n>
				</span>
				<span class="right-magnet" style="line-height: 50px" ng-if="category.nbNewMessages === 1">
					[[category.nbNewMessages]]
					<i18n>forum.message.new.single</i18n>
				</span>
				<span class="right-magnet" style="line-height: 50px" ng-if="category.nbNewMessages === 0">
					<i18n>forum.message.new.none</i18n>
				</span>
			</strong>
			<div class="small-hidden bottom-locked">
				<behaviour name="manage" resource="cat">
					<button ng-click="editCategory(cat, $event)">Modifier</button>
					<button ng-click="removeCategory(cat, $event)">Supprimer</button>
					<button ng-click="shareCategory(cat, $event)">Partager</button>
				</behaviour>

			</div>
		</article>
	</div>
</div>

<!-- Lightbox : Thread share -->
<div ng-if="display.showPanel">
	<lightbox show="display.showPanel" on-close="display.showPanel = false;">
		<share-panel app-prefix="'forum'" resources="category"></share-panel>
	</lightbox>
</div>

<div ng-if="display.confirmDeleteCategories">
	<lightbox show="display.confirmDeleteCategories" on-close="cancelRemoveCategories()">
		<div class="row" ng-if="categories.selection().length === 1">
			<i18n>forum.confirm.delete.category</i18n>
		</div>
		<div class="row" ng-if="categories.selection().length > 1">
			<i18n>forum.confirm.delete.categories</i18n>
		</div>
		<div class="row">
			<button class="right-magnet" ng-click="removeSelectedCategories()"><i18n>remove</i18n></button>
			<input type="button" class="cancel right-magnet" i18n-value="cancel" ng-click="cancelRemoveCategories()" />
		</div>
	</lightbox>
</div>

<section class="toggle-buttons" ng-class="{ hide: categories.selection().length === 0 }">
	<div class="toggle">
		<div class="row">
			<behaviour name="manage" resource="categories.selection()" class="cell">
				<button ng-click="editCategory()" ng-if="categories.selection().length === 1"><i18n>edit</i18n></button>
			</behaviour>
			<behaviour name="manage" resource="categories.selection()" class="cell">
				<button ng-click="confirmRemoveSelectedCategories()"><i18n>remove</i18n></button>
			</behaviour>
			<behaviour name="share" resource="categories.selection()" class="cell">
				<button ng-click="display.showPanel = true;"><i18n>share</i18n></button>
			</behaviour>
		</div>
	</div>
</section>